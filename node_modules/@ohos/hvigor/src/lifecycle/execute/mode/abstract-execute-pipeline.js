"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractExecutePipeline=void 0;const hvigor_base_1=require("@ohos/hvigor-base"),profile_js_1=require("../../profile.js"),sync_js_1=require("../../sync.js"),_log=hvigor_base_1.HvigorLogger.getLogger("hvigor-abstract-pipeline");class AbstractExecutePipeline{constructor(e,t){this.shouldCheckTask=!1,this.project=e,this.taskOptions=t}startPipeline(){if(this.taskOptions.isNeedSync)return this.executeSyncTask(),void(0,sync_js_1.outputPluginSyncInfo)();this.recordTraceData(),this.executeTask()}doOneNodeSync(e){profile_js_1.profile.executed+=1,(0,sync_js_1.sync)(e)}doOneNodeTask(e){const t=this.taskOptions.toRunTasks,s=t.length?t:["default"],o=s.filter((t=>e.hasTask(t)));if(this.shouldCheckTask&&0===o.length&&_log.errorMessageExit(`Task ${s} not found in hvigor node:${e.getName()}.`),0===o.length)return void _log.debug(`No task found to execute in ${e.getName()}!`);profile_js_1.profile.executed+=o.length;const i=o.map((t=>e.getTaskByName(t).getPath()));hvigor_base_1.taskExecutorInst.executeTaskByName(i)}recordTraceData(){hvigor_base_1.traceBuildAnalyze.moduleNum=this.project.getAllSubModules().length}}exports.AbstractExecutePipeline=AbstractExecutePipeline;