"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SdkInfo=void 0;const sdkmanager_common_1=require("@ohos/sdkmanager-common"),sdk_ets_component_js_1=require("./impl/sdk-ets-component.js"),sdk_js_component_js_1=require("./impl/sdk-js-component.js"),sdk_toolchains_component_js_1=require("./impl/sdk-toolchains-component.js"),sdk_native_component_js_1=require("./impl/sdk-native-component.js"),path_1=__importDefault(require("path")),property_get_js_1=require("./lib/property-get.js"),ohos_logger_1=require("../utils/log/ohos-logger"),scan_local_sdk_1=require("./scan-local-sdk");class SdkInfo{constructor(t,o){this._log=ohos_logger_1.OhosLogger.getLogger(SdkInfo.name),this._baseDir=property_get_js_1.Property.getInstance().getSdkDir(),this._sdkVersion=t,this._localSdkComponents=scan_local_sdk_1.scanLocalSdkInst.setSdKBaseDir(this._baseDir).getLocalSdkComponents(),o.forEach(this.initComponents,this)}getBaseDir(){return path_1.default.resolve(this._baseDir)}getModuleSchema(){return this.toolchainsComponent?this.toolchainsComponent.getModuleSchema():""}getAppSchema(){return this.toolchainsComponent?this.toolchainsComponent.getAppSchema():""}getFormSchema(){return this.toolchainsComponent?this.toolchainsComponent.getFormSchema():""}getSdkJsDir(){return this.jsComponent?this.jsComponent.getBaseDir():""}getSdkEtsDir(){return this.etsComponent?this.etsComponent.getBaseDir():""}getSdkVersion(){return this._sdkVersion}getHapTobin(){return this.jsComponent.getHapToBinFilePath()}getReleaseType(){return this.toolchainsComponent?this.toolchainsComponent.getReleaseType():"Release"}getSdkNativeDir(){return this.nativeComponent.getBaseDir()}getCmakeTool(){return this.nativeComponent.getCmakeTool()}getNativeNinjaTool(){return this.nativeComponent.getNinjaTool()}getNativeToolchain(){return this.nativeComponent.getNativeToolchain()}getSdkToolchainsDir(){return this.toolchainsComponent?this.toolchainsComponent.getBaseDir():""}getRestool(){return this.toolchainsComponent?this.toolchainsComponent.getRestoolPath():""}getSysCapTool(){return this.toolchainsComponent?this.toolchainsComponent.getSysCapToolPath():""}getSysCapFileInEts(){return this.etsComponent?this.etsComponent.getSysCapFilePath():""}getSysCapFileInJs(){return this.jsComponent?this.jsComponent.getSysCapFilePath():""}getVerifySignConfigTool(){return this.toolchainsComponent?this.toolchainsComponent.getVerifySignConfigToolPath():""}getJsArkVersion(){return this.jsComponent?this.jsComponent.getArkVersion():""}getRichSchema(){return this.toolchainsComponent?this.toolchainsComponent.getRichSchema():""}getLiteSchema(){return this.toolchainsComponent?this.toolchainsComponent.getLiteSchema():""}getEtsArkVersion(){return this.etsComponent?this.etsComponent.getArkVersion():""}getArkVersion(){return""===this.getEtsArkVersion()?this.getJsArkVersion():this.getEtsArkVersion()}getPackageTool(){return this.toolchainsComponent?this.toolchainsComponent.getPackageToolPath():""}getSignDir(){return this.toolchainsComponent?this.toolchainsComponent.getSignDir():""}getJsLoader(){return this.jsComponent?this.jsComponent.getJsLoaderPath():""}getEtsLoader(){return this.etsComponent?this.etsComponent.getEtsLoaderPath():""}initComponents(t){const o=this.findLocalComponent(t);switch(t){case sdkmanager_common_1.ComponentPath.JS:this.jsComponent=new sdk_js_component_js_1.SdkJsComponent(o);break;case sdkmanager_common_1.ComponentPath.ETS:this.etsComponent=new sdk_ets_component_js_1.SdkEtsComponent(o);break;case sdkmanager_common_1.ComponentPath.TOOLCHAINS:this.toolchainsComponent=new sdk_toolchains_component_js_1.SdkToolchainsComponent(o);break;case sdkmanager_common_1.ComponentPath.NATIVE:this.nativeComponent=new sdk_native_component_js_1.SdkNativeComponent(o)}}findLocalComponent(t){var o;const e=null===(o=this._localSdkComponents)||void 0===o?void 0:o.get(new sdkmanager_common_1.PathAndApiVersion(t,this._sdkVersion));return void 0===e&&this._log._buildError(`Can not find the sdk type ${t} of API${this._sdkVersion}, Please download first.`)._solution(`Check the sdk.dir,or install API${this._sdkVersion} ${t}. Please Open SDK Manager`)._file(this._baseDir)._printErrorAndExit(),e}}exports.SdkInfo=SdkInfo;