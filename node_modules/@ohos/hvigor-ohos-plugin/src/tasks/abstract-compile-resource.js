"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractCompileResource=void 0;const ohos_hap_task_js_1=require("./task/ohos-hap-task.js"),restool_command_builder_js_1=require("../builder/restool-command-builder.js"),path_1=__importDefault(require("path")),process_utils_js_1=require("../utils/process-utils.js");class AbstractCompileResource extends ohos_hap_task_js_1.OhosHapTask{getResToolFile(){return this.service.getSdkInfo().getRestool()}getCommonResToolBuilder(e){const t=this.service.getModuleModel(),o=new restool_command_builder_js_1.RestoolCommandBuilder(this.getResToolFile()).addInputDir(t.getSourceSetByTargetName(e.getTargetName()).getSourceSetRoot()).addModules(this.getRestoolModules(e).join(",")).forceDelete();return this.service.getDependencyRootPaths().reverse().forEach((e=>{o.addInputDir(path_1.default.resolve(e,"src","main"))})),o}getRestoolModules(e){return[...new Set([this.moduleModel.getName(),this.moduleModel.getSourceSetByTargetName(e.getTargetName()).getLegacyModuleTargetRes().getConfigJsonOpt().module.distro.moduleName,...this.service.getProjectModel().getSubProjects().keys()])]}compile(e,t){const o=e.build();t._printDebugCommand("restool",o),new process_utils_js_1.ProcessUtils(this.moduleName,this.name).executeSync(o)}}exports.AbstractCompileResource=AbstractCompileResource;