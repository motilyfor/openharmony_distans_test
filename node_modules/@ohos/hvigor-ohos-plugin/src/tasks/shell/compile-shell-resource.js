"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompileShellResource=void 0;const file_util_js_1=require("../../utils/file-util.js"),build_directory_const_js_1=require("../../const/build-directory-const.js"),path_1=__importDefault(require("path")),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),project_file_reader_js_1=require("../../utils/project-file-reader.js"),abstract_compile_resource_js_1=require("../abstract-compile-resource.js"),runtime_type_enum_js_1=require("../../enum/runtime-type-enum.js"),hos_sdk_info_js_1=require("../../sdk/hos-sdk-info.js"),task_names_js_1=require("../common/task-names.js");var ShellTask=task_names_js_1.TaskNames.ShellTask;const legacy_process_profile_js_1=require("../legacy-tasks/legacy-process-profile.js");class CompileShellResource extends abstract_compile_resource_js_1.AbstractCompileResource{constructor(e){super(e,ShellTask.COMPILE_SHELL_RESOURCES),this._log=ohos_logger_js_1.OhosLogger.getLogger(CompileShellResource.name)}initTaskDepends(){this.module.registryDependsOnTask(this,new legacy_process_profile_js_1.LegacyProcessProfile(this.service))}taskShouldDo(e){return e.getTargetStatus().is(runtime_type_enum_js_1.RuntimeTypeEnum.HARMONY_OS)}beforeTask(e){file_util_js_1.FileUtil.checkDirWithoutDelete(this.getTaskTempDir(e));const s=e.getPathInfo();file_util_js_1.FileUtil.checkDirWithoutDelete(s.getShellSrcMain())}getResToolFile(){return hos_sdk_info_js_1.HosSdkInfo.getInstance(this.moduleModel.getCompileApiVersion()).getResTool()}doTaskAction(e){const s=e.getPathInfo(),t=s.getIntermediatesProcessLegacyProfile(),o=this.getCommonResToolBuilder(e);o.addJsonFile(t).addModulePackName(project_file_reader_js_1.ProjectFileReader.getJson5Obj(t).app.bundleName).addOutputDir(this.getTaskTempDir(e)).addResTable(path_1.default.resolve(this.getTaskTempDir(e),build_directory_const_js_1.BuildArtifactConst.RESOURCE_TABLE_JAVA)).addOutputBak(s.getShellSrcMain()),this.compile(o,this._log)}}exports.CompileShellResource=CompileShellResource;